<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>LHCb Starterkit: First Steps in LHCb</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/>
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="https://lhcb.github.io/first-analysis-steps/">
          <img src="img/starterkit.png" height="100" alt="LHCb Starterkit">
        </a>
      </div>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
          <h1 class="title">First Steps in LHCb</h1>
          <h2 class="subtitle">Minimal DaVinci on the grid</h2>
<div id="learning-objectives" class="objectives panel panel-warning">
<div class="panel-heading">
<h2><span class="glyphicon glyphicon-certificate"></span>Learning Objectives</h2>
</div>
<div class="panel-body">
<ul>
<li>Create a ganga job</li>
<li>Submit a ganga job</li>
<li>Waiting for ganga</li>
<li>Find the job output</li>
</ul>
</div>
</div>
<p>This lesson will teach you how to take our <a href="09-minimal-dv-job.html">minimal DaVinci job</a> and run it on the grid.</p>
<p><code>ganga</code> is a program which you can use to interact with your grid jobs. Start it with:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">SetupProject</span> Ganga
$ <span class="kw">ganga</span></code></pre>
<p>After <code>ganga</code> has started you will be dropped into something that looks very much like an <code>ipython</code> session. <code>ganga</code> is built on top of <code>ipython</code> so you can type anything that is legal <code>python</code> in addition to some special commands provided by <code>ganga</code>.</p>
<p>To create your first <code>ganga</code> job type the following:</p>
<pre class="sourceCode python"><code class="sourceCode python">j = Job(application=DaVinci(version=<span class="st">&#39;v36r6&#39;</span>))
j.backend = Dirac()
j.name = <span class="st">&quot;First ganga job&quot;</span>
j.inputdata = j.application.readInputData(<span class="st">&#39;data/MC_2012_27163003_Beam4000GeV2012MagDownNu2.5Pythia8_Sim08e_Digi13_Trig0x409f0045_Reco14a_Stripping20NoPrescalingFlagged_ALLSTREAMS.DST.py&#39;</span>)
j.application.optsfile = <span class="st">&#39;code/11-grid_ntuple.py&#39;</span></code></pre>
<p>This will create a <code>Job</code> object that will execute <code>DaVinci</code> using a backend called <code>Dirac</code>, which is &quot;the grid&quot;. Instead of specifying the files to process as part of the options file you have now tell the <code>Job</code> about it. This means allows <code>ganga</code> to split your job up, processing different files simultaneously. The final property to set is the <code>j.application.optsfile</code> which specifies the options file to use to configure the job.</p>
<p>Now you have created your first job, however it has not started running yet. To submit it type <code>j.submit()</code>. Now <code>ganga</code> will do the equivalent of <code>SetupProject DaVinci v36r6</code>, prepare your job and then ship it off to the grid.</p>
<p>While it runs, let's submit an identical job via slightly different method. Having to type in the details of each job every time you want to run it is error prone and tedious. Instead you can place all the lines that define a job in a file and simply run that. Quit <code>ganga</code> by pressing Ctrl-d (Control - d). It will ask if you reall want to quit, so say Yes.</p>
<p>Place the following in a file called <code>first-job.py</code>:</p>
<pre class="sourceCode python"><code class="sourceCode python">j = Job(application=DaVinci(version=<span class="st">&#39;v36r6&#39;</span>))
j.backend = Dirac()
j.name = <span class="st">&quot;First ganga job&quot;</span>
j.inputdata = j.application.readInputData(<span class="st">&#39;data/MC_2012_27163003_Beam4000GeV2012MagDownNu2.5Pythia8_Sim08e_Digi13_Trig0x409f0045_Reco14a_Stripping20NoPrescalingFlagged_ALLSTREAMS.DST.py&#39;</span>)
j.application.optsfile = <span class="st">&#39;code/11-grid_ntuple.py&#39;</span></code></pre>
<p>Which you can execute and submit like so:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">ganga</span> first-job.py</code></pre>
<p>This will print output similar to submitting the job from with in <code>ganga</code>. Once it is done, start <code>ganga</code> again.</p>
<p>You can check on your jobs by typing <code>jobs()</code> into a <code>ganga</code> console. This will list all of your jobs, their status, what kind of application they are and more.</p>
<p>You can get more detailed information about your job by typing <code>jobs($jobid)</code>. Replacing <code>$jobid</code> with the <code>id</code> of the job you are interested in.</p>
        </div>
      </div>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a>
        <a class="label swc-blue-bg" href="https://github.com/lhcb/first-analysis-steps">Source</a>
        <a class="label swc-blue-bg" href="mailto:lhcb-starterkit@cern.ch">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="http://software-carpentry.org/v5/js/jquery-1.9.1.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
  </body>
</html>
